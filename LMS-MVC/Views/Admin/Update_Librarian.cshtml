@{
    Layout = "_AdminDashboard";
}
<div class="container-fluid py-4" id="collapseExample">
    <div class="row">
        <div class="col-12">
            <div class="card-body px-0 pb-2 bg-white " style="border-radius: 15px;">
                <div class="col-10 col-lg-3 d-flex">
                    <div class="input-group input-group-static my-3" style="margin-left: 20px;">
                        <label>Librarian ID: </label>
                        <input type="text" class="form-control" id="idofuser">
                    </div>
                </div>
                <button class="btn btn-primary" type="button" style="margin-left: 20px;" id="find">Search</button>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid py-4" id="collapseExampl" >
    <div class="card card-body ">
        <partial name="_partialErrorSuccess" />
        <form action="/Admin/Update_Librarian" method="post">
            <div class="row  ">
                <div class="row ">
                    <div class="col-12 col-xl-6">
                        <div class="card card-plain h-100">
                            <div class="card-body p-3">
                                <ul class="list-group">
                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4">
                                            <label>Librarian ID</label>
                                            <input type="text" name="id"  id="id" class="form-control" required readonly>
                                        </div>
                                    </li>
                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4">
                                            <label>Name</label>
                                            <input type="text" name="name" id="name" class="form-control" required>
                                        </div>
                                    </li>
                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4">
                                            <label>Password</label>
                                            <input type="password" class="form-control" id="password" minlength="8" name="password" pattern="^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9!#%])(?=.{8,})[^\s]+$" required>
                                        </div>
                                    </li>
                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4">
                                            <label>CNIC</label>
                                            <input type="text" class="form-control" id ="cnic"  name="cnic" required />
                                        </div>
                                    </li>


                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4">
                                            <label>Date of Birth</label>
                                            <input type="date" class="form-control" id="dob" required name="dob" />
                                        </div>
                                    </li>

                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4">
                                            <label>Contact</label>
                                            <input type="number" class="form-control" id="contact" maxlength="11" minlength="11" required name="contact" />
                                        </div>
                                    </li>

                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-xl-6">
                        <div class="card card-plain h-100">

                            <div class="card-body p-3">
                                <ul class="list-group">

                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4">
                                            <label>Email</label>
                                            <input type="email" class="form-control" id="email" name="email" required>
                                        </div>
                                    </li>
                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4">
                                            <label>Qualification</label>
                                            <select class="form-control" name="qualification" id="quaf" required>
                                                <option disabled selected ></option>
                                                <option value="master">Master's Degree in Library and Information Science</option>
                                                <option value="bachelor">Bachelor's Degree in Library Science</option>
                                                <option value="associate">Associate Degree in Library Technology</option>
                                            </select>
                                        </div>
                                    </li>
                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4">
                                            <label>Sallary</label>
                                            <input type="number" class="form-control" id="sallary" name="sallary" required />
                                        </div>
                                    </li>

                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4 mt-5">
                                            <label>Work Shift: </label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="workshift" value="morning" id="mor" required />
                                                <label class="form-check-label" for="mor"> Morning </label>

                                                <input class="form-check-input" type="radio" name="workshift" value="evening" id="eve" required />
                                                <label class="form-check-label" for="eve"> Evening </label>
                                            </div>

                                        </div>
                                    </li>
                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4 mt-4">
                                            <label>Gender: </label>

                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="gender" value="male" id="male" required />
                                                <label class="form-check-label" for="male"> Male </label>

                                                <input class="form-check-input" type="radio" name="gender" value="female" id="female" required />
                                                <label class="form-check-label" for="female"> Female </label>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="list-group-item border-0 px-0">
                                        <div class="input-group input-group-static mb-4 mt-4">
                                            <label>Status: </label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="active" value="1" id="active" required />
                                                <label class="form-check-label" for="active"> Active </label>
                                                <input class="form-check-input" type="radio" name="active" value="0" id="inactive" required />
                                                <label class="form-check-label" for="inactive"> In-active </label>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            <input type="submit" class="btn bg-success text-white col-4  m-auto " value="Submit">
            </div>
        </form>
    </div>
</div>
<script>
    var z = "@ViewBag.status";
    if (z == "success") {
        document.getElementById("success_msg").style.display = 'block';
        document.getElementById("show_success_msg").innerText = " Successfully Updated  ID : @ViewBag.assignid";
    }
    else if (z == "error") {
        document.getElementById("error_msg").style.display = 'block';
        document.getElementById("show_error_msg").innerText = " Try Again !!!";
    }

    // Assuming you have included the jQuery library in your HTML

    $(document).ready(function () {
        $('#find').click(function () {
            var s=document.getElementById("idofuser").value;
            $.ajax({
                url: `/Admin/Update_Librarian?u_id=${s}`,
                type: 'GET', 
                success: function (response) {
                
                    var data = JSON.parse(response);
                    if (data.Status=="Finded")
                    {
                        var date = new Date(data.user.DateOfBirth);
                        // Format the date to the desired format: "YYYY-MM-DD"
                        var formattedDate = date.toISOString().split("T")[0];
                        document.getElementById("id").value = data.user.Id;
                        document.getElementById("name").value = data.user.Name;
                        document.getElementById("password").value=data.user.Password;
                        document.getElementById("cnic").value = data.cnic;
                        document.getElementById("dob").value = formattedDate;
                        document.getElementById("contact").value =data.user.Contact;
                        document.getElementById("sallary").value = data.sallary;
                        document.getElementById("email").value = data.user.Email;
                        if (data.user.IsActive == true) {
                           document.getElementById("active").checked = true;
                        } else if (data.user.IsActive == false) {
                            document.getElementById("inactive").checked = true;
                        }
                        if (data.gender == "male") {
                            document.getElementById("male").checked = true;
                        } else if (data.gender == "female") {
                            document.getElementById("female").checked = true;
                        }
                        if (data.work== "morning") {
                            document.getElementById("mor").checked = true;
                        } else if (data.work == "evening") {
                            document.getElementById("eve").checked = true;
                        }
                        var selectElement=document.getElementById("quaf");
                        for (var i = 0; i < selectElement.options.length; i++) {
                      
                            if (selectElement.options[i].value ===  data.qual) {
                          
                                selectElement.options[i].selected = true;
                                break;
                            }
                        }
                    }
                    else
                    {
                      
                        document.getElementById("error_msg").style.display = 'block';
                        document.getElementById("show_error_msg").innerText = "Incorrect Librarian ID - Try Again !!!";
                     setTimeout(function () {
                        document.getElementById("error_alert").click();
                     },5000);
                    }
                },
                error: function (error) {
                    // Handle any errors that occur during the request
                    console.log(error);
                }
            });
        });
    });

</script>